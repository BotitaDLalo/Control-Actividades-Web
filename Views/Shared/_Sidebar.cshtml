@* Partial sidebar responsivo para Alumno / Docente (simplificada y con mini-menú) *@
@using System.Security.Principal
@{
    var isDocente = User.IsInRole("Docente");
    var isAlumno = User.IsInRole("Alumno");
    var userName = User.Identity.IsAuthenticated ? User.Identity.Name : "Usuario";
}
<nav class="app-sidebar" id="appSidebar" role="navigation" aria-label="Sidebar">
    <div class="sidebar-left">
        <a class="small-logo" href="@Url.Action("Index","Home")" title="Ir al inicio" style="display:block;margin-bottom:8px">
            <img src="@Url.Content("~/Content/Iconos/LOGO-32.png")" alt="logo" style="height:34px;" onerror="this.style.display='none'" />
        </a>

        <ul class="sidebar-icons">
            <!-- Icons that used to be in the top header, moved to the left -->
            <li class="icon-item" data-target="menu-cursos" title="Cursos" tabindex="0">
                <!-- graduation cap -->
                <svg viewBox="0 0 24 24" class="icon"><path d="M12 3L1 9l11 6 9-4.91V17h2V9L12 3zM4 10.91V12l8 4.36V14L4 10.91z"/></svg>
            </li>
            <li class="icon-item" data-target="menu-calendario" title="Calendario" tabindex="0">
                <svg viewBox="0 0 24 24" class="icon"><path d="M7 10h5v5H7z"/><path d="M19 4h-1V2h-2v2H8V2H6v2H5a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2zM5 20V9h14l.002 11H5z"/></svg>
            </li>

            <!-- main navigation icons -->
            <li class="icon-item active" data-target="menu-home" title="Inicio" tabindex="0">
                <svg viewBox="0 0 24 24" class="icon"><path d="M3 11.5L12 4l9 7.5V20a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1z"/></svg>
            </li>
            <li class="icon-item" data-target="menu-actividades" title="Actividades" tabindex="0">
                <svg viewBox="0 0 24 24" class="icon"><path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zM13 21h8V11h-8v10zm0-18v6h8V3h-8z"/></svg>
            </li>

            <li class="icon-item" data-target="menu-ia" title="IA" tabindex="0">
                <svg viewBox="0 0 24 24" class="icon"><path d="M12 3C7.03 3 3 6.69 3 11c0 2.28 1.14 4.34 3 5.7V21l4.06-2.03c.63.08 1.28.13 1.94.13 4.97 0 9-3.69 9-8.99S16.97 3 12 3zM9 11H7v-2h2v2zm6 0h-4v-2h4v2z"/></svg>
            </li>

            <li class="icon-item" data-target="menu-notificaciones" title="Notificaciones" tabindex="0">
                <svg viewBox="0 0 24 24" class="icon"><path d="M12 22a2 2 0 0 0 2-2H10a2 2 0 0 0 2 2zm6-6V11c0-3.07-1.63-5.64-4.5-6.32V4a1.5 1.5 0 0 0-3 0v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/></svg>
            </li>

            <li class="icon-item" data-target="menu-perfil" title="Perfil" tabindex="0">
                <svg viewBox="0 0 24 24" class="icon"><path d="M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10z"/><path d="M2 22c0-4 4-6 10-6s10 2 10 6v1H2v-1z"/></svg>
            </li>
        </ul>
    </div>

    <div class="sidebar-content" id="sidebarContent">
        <!-- Removed the oversized brand/actions block to avoid overlap -->

        <div class="menu-section" id="menu-cursos">
            <h5 class="menu-title" tabindex="0">Cursos</h5>
            <ul class="menu-list submenu" id="cursos-list">
                <li class="loading">Cargando...</li>
            </ul>
        </div>

        <div class="menu-section open" id="menu-home">
            <h5 class="menu-title" tabindex="0">Inicio</h5>
            <ul class="menu-list submenu">
                @if (isAlumno)
                {
                    <li>@Html.ActionLink("Mis Clases", "Index", "Alumno")</li>
                    <li>@Html.ActionLink("Unirse a Clase", "Unirse", "Alumno")</li>
                }
                @if (isDocente)
                {
                    <li>@Html.ActionLink("Panel Docente", "Index", "Docente")</li>
                }
            </ul>
        </div>

        <div class="menu-section" id="menu-actividades">
            <h5 class="menu-title" tabindex="0">Actividades</h5>
            <ul class="menu-list submenu">
                @if (isDocente)
                {
                    <li>@Html.ActionLink("Crear Actividad", "Crear", "Actividad")</li>
                    <li>@Html.ActionLink("Gestionar Entregas", "Entregas", "Docente")</li>
                }
                else if (isAlumno)
                {
                    <li>@Html.ActionLink("Ver Actividades", "Index", "Actividad")</li>
                    <li>@Html.ActionLink("Mis Entregas", "MisEntregas", "Alumno")</li>
                }
            </ul>
        </div>

        <div class="menu-section" id="menu-ia">
            <h5 class="menu-title" tabindex="0">IA</h5>
            <ul class="menu-list submenu">
                <li>@Html.ActionLink("Chat IA", "Chat", "IA")</li>
                <li>@Html.ActionLink("Historial IA", "Historial", "IA")</li>
            </ul>
        </div>

        <div class="menu-section" id="menu-notificaciones">
            <h5 class="menu-title" tabindex="0">Notificaciones</h5>
            <ul class="menu-list submenu">
                <li>@Html.ActionLink("Ver Notificaciones", "Index", "Notificaciones")</li>
                <li>@Html.ActionLink("Ajustes de Notificaciones", "Settings", "Notificaciones")</li>
            </ul>
        </div>

        <div class="menu-section" id="menu-perfil">
            <h5 class="menu-title" tabindex="0">Cuenta</h5>
            <ul class="menu-list submenu">
                <li class="username">@userName</li>
                <li>
                    @using (Html.BeginForm("LogOff", "Account", FormMethod.Post, new { @class = "logout-form" }))
                    {
                        @Html.AntiForgeryToken()
                        <button type="submit" class="logout-btn">Cerrar sesión</button>
                    }
                </li>
            </ul>
        </div>
    </div>
</nav>